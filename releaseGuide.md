## Releasing New Versions and Packaging with GoReleaser 

**codeleft-cli** leverages **GoReleaser** for streamlined version releases and multi-platform packaging. GoReleaser automates the entire release process for Go projects, from tagging and building to publishing and creating GitHub releases.

### How GoReleaser Automates Releases

GoReleaser works by reading a configuration file (typically `.goreleaser.yaml` in the project root) that defines how your project should be built, packaged, and released. This configuration specifies:

* **Builds**: How to compile the Go application for various operating systems and architectures (e.g., Linux, Windows, macOS; x86\_64, ARM).
* **Archives**: How to compress the compiled binaries into archives (e.g., `.tar.gz`, `.zip`).
* **Checksums**: How to generate checksums for verifying file integrity.
* **Signatures**: How to sign your builds using Cosign for supply chain security.
* **GitHub Releases**: How to create a new GitHub release, including release notes, attaching assets (the packaged binaries), and tagging the commit.
* **Publishers**: How to publish artifacts to various package managers (e.g., Homebrew taps, Scoop manifests) or artifact repositories.

### Releasing a New Version

To release a new version of `codeleft-cli` using GoReleaser, you typically follow these steps:

1.  **Ensure your `.goreleaser.yaml` is configured correctly.** This file dictates how GoReleaser will build and package your application. You'll define the target operating systems, architectures, archive formats, and any post-build hooks or publishing steps.

    An example snippet from a `.goreleaser.yaml` might look like this, enabling builds for Linux, Windows, and macOS: 

    ```yaml
    builds:
      - env:
          - CGO_ENABLED=0
        goos:
          - linux
          - windows
          - darwin
        goarch:
          - amd64
          - arm64
    archives:
      - format: tar.gz
        # this name template makes the OS and Arch part of the filename.
        name_template: "{{ .ProjectName }}_{{ .Os }}_{{ .Arch }}"
        # files to add to the archive
        files:
          - README.md
          - LICENSE.md
    checksum:
      name_template: 'checksums.txt'
    snapshot:
      name_template: "{{ .Tag }}-next"
    changelog:
      sort: asc
      filters:
        exclude:
          - '^docs:'
          - '^test:'
    ```

2.  **Tag your release commit.** GoReleaser relies on Git tags to identify release versions. For example, if you're releasing version `1.0.9`, you would create a new Git tag:

    ```bash
    git tag v1.0.9
    ```

3.  **Push your changes and the tag to GitHub:**

    ```bash
    git push origin main
    git push origin v1.0.9
    ```

4.  **Run GoReleaser.** You can run GoReleaser locally (for testing) or, more commonly, within your CI/CD pipeline (e.g., GitHub Actions, GitLab CI).

    To run a full release (which will create a GitHub release and upload artifacts):

    ```bash
    goreleaser release --clean
    ```

    For a dry run without publishing (useful for testing your `.goreleaser.yaml`):

    ```bash
    goreleaser release --clean --snapshot --skip-publish
    ```

    Once GoReleaser completes, you'll find a new release on your GitHub repository's "Releases" page, complete with the compiled binaries for different machines.

### Packaging for Different Machine Types

GoReleaser excels at cross-compilation and packaging for a variety of operating systems and architectures. This is configured primarily within the `builds` section of your `.goreleaser.yaml`.

For `codeleft-cli`, the existing installation instructions already highlight this: "Download the appropriate binary from the [GitHub Releases](https://github.com/henrylamb/codeleft-cli/releases). Look for an archive that matches your operating system and architecture, for example: `codeleft-cli_Linux_x86_64.tar.gz`."

This `codeleft-cli_Linux_x86_64.tar.gz` (and similar files for other platforms) is automatically generated by GoReleaser. When `codeleft-cli` is built, GoReleaser compiles it for:

* **Operating Systems**: `Linux`, `Windows`, `macOS` (Darwin)
* **Architectures**: `x86_64` (amd64), `ARM64`

Each combination results in a separate binary, which is then archived (e.g., as a `.tar.gz` or `.zip` file) and uploaded to the GitHub release. This ensures users can easily download a version of `codeleft-cli` that is specifically compiled for their machine, providing optimal performance and compatibility.